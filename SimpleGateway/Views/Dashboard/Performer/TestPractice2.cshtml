@model SimpleGateway.Models.TestDataModel2
@{
    ViewData["Title"] = "Test Practice 2 - Dental Procedures Assessment";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h2>Test Practice 2 - Dental Procedures Assessment - @ViewBag.PerformerName</h2>
            @if (!string.IsNullOrEmpty(TempData["SuccessMessage"] as string))
            {
                <div class="alert alert-success">
                    @TempData["SuccessMessage"]
                    @if (TempData["TotalRecords"] != null)
                    {
                        <br><strong>Total records in PostgreSQL database:</strong> @TempData["TotalRecords"]
                    }
                </div>
            }
            
            @if (!string.IsNullOrEmpty(TempData["ErrorMessage"] as string))
            {
                <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
            }
        </div>
    </div>
    <div class="row">
        <div class="col-3">
            <ul class="list-group">
                <li class="list-group-item @(ViewBag.ActiveSection == "Dashboard" ? "active" : "")">
                    <a href="/Dashboard/ViewPerformerDashboard?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "Dashboard" ? "color: white;" : "")">
                        <i class="bi bi-speedometer2"></i> Dashboard Overview
                    </a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "PerformerDetails" ? "active" : "")">
                    <a href="/Dashboard/PerformerDetails?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "PerformerDetails" ? "color: white;" : "")">Performer Details</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "TestPractice" ? "active" : "")">
                    <a href="/Dashboard/TestPractice?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "TestPractice" ? "color: white;" : "")">Test Practice</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "TestPractice2" ? "active" : "")">
                    <a href="/Dashboard/TestPractice2?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "TestPractice2" ? "color: white;" : "")">Test Practice 2</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "Uploads" ? "active" : "")">
                    <a href="/Dashboard/Uploads?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "Uploads" ? "color: white;" : "")">Uploads</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "StructuredConversation" ? "active" : "")">
                    <a href="/Dashboard/StructuredConversation?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "StructuredConversation" ? "color: white;" : "")">Structured Conversation</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "AgreementTerms" ? "active" : "")">
                    <a href="/Dashboard/AgreementTerms?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "AgreementTerms" ? "color: white;" : "")">Agreement Terms</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "WorkBasedAssessments" ? "active" : "")">
                    <a href="/Dashboard/WorkBasedAssessments?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "WorkBasedAssessments" ? "color: white;" : "")">Work Based Assessments</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "CPD" ? "active" : "")">
                    <a href="/Dashboard/CPD?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "CPD" ? "color: white;" : "")">CPD</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "MSF" ? "active" : "")">
                    <a href="/Dashboard/MSF?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "MSF" ? "color: white;" : "")">MSF</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "PSQ" ? "active" : "")">
                    <a href="/Dashboard/PSQ?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "PSQ" ? "color: white;" : "")">PSQ</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "ClinicalNoteAudit" ? "active" : "")">
                    <a href="/Dashboard/ClinicalNoteAudit?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "ClinicalNoteAudit" ? "color: white;" : "")">Clinical Note Audit</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "HelpGuidance" ? "active" : "")">
                    <a href="/Dashboard/HelpGuidance?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "HelpGuidance" ? "color: white;" : "")">Help & Guidance</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "FinalSignOff" ? "active" : "")">
                    <a href="/Dashboard/FinalSignOff?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "FinalSignOff" ? "color: white;" : "")">Final Sign off</a>
                </li>
                @if (ViewBag.IsOwnDashboard == true)
                {
                    <li class="list-group-item"><a href="/Account/Logout">Logout</a></li>
                }
                else
                {
                    <li class="list-group-item"><a href="/Dashboard/Index">Back to List</a></li>
                }
            </ul>
        </div>
        <div class="col-9">
            <form method="post" asp-action="TestPractice2">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                
                <!-- Registration and Qualifications -->
                <div class="card mb-4">
                    <div class="card-header" style="background-color: #9bb3d1; color: #4a5568;">
                        <h5 class="mb-0">Registration and Qualifications</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label asp-for="GDCRegistrationNumber" class="form-label">GDC registration number:</label>
                                <input asp-for="GDCRegistrationNumber" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" />
                                <span asp-validation-for="GDCRegistrationNumber" class="text-danger"></span>
                            </div>
                            <div class="col-md-6">
                                <label asp-for="UKRegistrationDate" class="form-label">Date of UK registration as a dentist:</label>
                                <input asp-for="UKRegistrationDate" class="form-control" placeholder="e.g. July 2020" readonly="@(!ViewBag.CanEditMainFields)" />
                                <span asp-validation-for="UKRegistrationDate" class="text-danger"></span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label asp-for="GDCRegistrationGaps" class="form-label">If there are any gaps in your registration with the GDC please explain:</label>
                            <textarea asp-for="GDCRegistrationGaps" class="form-control" rows="2" readonly="@(!ViewBag.CanEditMainFields)"></textarea>
                            <span asp-validation-for="GDCRegistrationGaps" class="text-danger"></span>
                        </div>
                        
                        <h6 class="mt-4 mb-3">Please list your professional qualifications in relation to your role as a dentist/specialist (with your primary dental qualification first). Add additional rows if necessary:</h6>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 25%;">Qualification:</th>
                                        <th style="width: 25%;">Country where obtained:</th>
                                        <th style="width: 25%;">Institution where obtained:</th>
                                        <th style="width: 25%;">Year obtained:</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input asp-for="Qualification1" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification1Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification1Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification1Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Qualification2" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification2Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification2Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification2Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Qualification3" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification3Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification3Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification3Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Qualification4" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification4Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification4Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification4Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Qualification5" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification5Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification5Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification5Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Qualification6" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification6Country" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification6Institution" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Qualification6Year" class="form-control" placeholder="e.g. 2018" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Employment History -->
                <div class="card mb-4">
                    <div class="card-header" style="background-color: #9bb3d1; color: #4a5568;">
                        <h5 class="mb-0">Employment History</h5>
                    </div>
                    <div class="card-body">
                        <h6 class="mt-2 mb-3">Please list your work as a dentist since initial qualification (most recent first):</h6>
                        
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 12%;">From (MM/YYYY):</th>
                                        <th style="width: 12%;">To (MM/YYYY):</th>
                                        <th style="width: 20%;">Job title/position:</th>
                                        <th style="width: 25%;">Address:</th>
                                        <th style="width: 13%;">Private/NHS:</th>
                                        <th style="width: 18%;">Patient types:</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input asp-for="Job1FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job1ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job1Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job1Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job1Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job1AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job1ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Job2FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job2ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job2Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job2Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job2Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job2AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job2ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Job3FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job3ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job3Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job3Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job3Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job3AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job3ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Job4FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job4ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job4Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job4Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job4Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job4AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job4ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Job5FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job5ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job5Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job5Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job5Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job5AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job5ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><input asp-for="Job6FromDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job6ToDate" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" placeholder="MM/YYYY" /></td>
                                        <td><input asp-for="Job6Title" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td><input asp-for="Job6Address" class="form-control" readonly="@(!ViewBag.CanEditMainFields)" /></td>
                                        <td>
                                            <select asp-for="Job6Type" class="form-control" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select...</option>
                                                <option value="Private">Private</option>
                                                <option value="NHS">NHS</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="checkbox" asp-for="Job6AdultPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Adult</label><br>
                                            <input type="checkbox" asp-for="Job6ChildPatients" class="form-check-input" disabled="@(!ViewBag.CanEditMainFields)" />
                                            <label class="form-check-label">Child</label>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Dental Procedures Assessment Table -->
                <div class="card">
                    <div class="card-header">
                        <h5>Dental Procedures Assessment</h5>
                        <p class="text-muted mb-0">Please complete the following table for each procedure type:</p>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th style="width: 25%;">Procedure Type</th>
                                        <th style="width: 15%;">Number Performed</th>
                                        <th style="width: 15%;">Confidence (1-6)</th>
                                        <th style="width: 20%;">Last Date</th>
                                        <th style="width: 25%;">Need Support?</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Clinical Exam/Assessments -->
                                    <tr>
                                        <td><strong>Clinical Exam/Assessments</strong></td>
                                        <td>
                                            <input asp-for="ClinicalExamNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="ClinicalExamConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="ClinicalExamLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="ClinicalExamNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="ClinicalExamNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Basic Periodontal Examinations (BPE) -->
                                    <tr>
                                        <td><strong>Basic Periodontal Examinations (BPE)</strong></td>
                                        <td>
                                            <input asp-for="BPENumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="BPEConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="BPELastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="BPENeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="BPENeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- 6-Point Pocket Chart (6PPC) -->
                                    <tr>
                                        <td><strong>6-Point Pocket Chart (6PPC)</strong></td>
                                        <td>
                                            <input asp-for="SixPPCNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="SixPPCConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="SixPPCLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="SixPPCNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="SixPPCNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Radiographs -->
                                    <tr>
                                        <td><strong>Radiographs</strong></td>
                                        <td>
                                            <input asp-for="RadiographsNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="RadiographsConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="RadiographsLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="RadiographsNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="RadiographsNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Extractions -->
                                    <tr>
                                        <td><strong>Extractions</strong></td>
                                        <td>
                                            <input asp-for="ExtractionsNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="ExtractionsConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="ExtractionsLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="ExtractionsNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="ExtractionsNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Extraction with root division -->
                                    <tr>
                                        <td><strong>Extraction with Root Division</strong></td>
                                        <td>
                                            <input asp-for="RootDivisionNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="RootDivisionConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="RootDivisionLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="RootDivisionNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="RootDivisionNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Scaling/root debridement -->
                                    <tr>
                                        <td><strong>Scaling/Root Debridement</strong></td>
                                        <td>
                                            <input asp-for="ScalingNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="ScalingConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="ScalingLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="ScalingNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="ScalingNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Amalgam fillings -->
                                    <tr>
                                        <td><strong>Amalgam Fillings</strong></td>
                                        <td>
                                            <input asp-for="AmalgamNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="AmalgamConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="AmalgamLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="AmalgamNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="AmalgamNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Composite fillings -->
                                    <tr>
                                        <td><strong>Composite Fillings</strong></td>
                                        <td>
                                            <input asp-for="CompositeNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="CompositeConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="CompositeLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="CompositeNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="CompositeNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Crowns/Veneers/Onlays -->
                                    <tr>
                                        <td><strong>Crowns/Veneers/Onlays</strong></td>
                                        <td>
                                            <input asp-for="CrownsNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="CrownsConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="CrownsLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="CrownsNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="CrownsNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Dentures -->
                                    <tr>
                                        <td><strong>Dentures</strong></td>
                                        <td>
                                            <input asp-for="DenturesNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="DenturesConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="DenturesLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="DenturesNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="DenturesNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Single Root Endo -->
                                    <tr>
                                        <td><strong>Single Root Endo</strong></td>
                                        <td>
                                            <input asp-for="SingleEndoNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="SingleEndoConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="SingleEndoLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="SingleEndoNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="SingleEndoNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Multi-Root Endo -->
                                    <tr>
                                        <td><strong>Multi-Root Endo</strong></td>
                                        <td>
                                            <input asp-for="MultiEndoNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="MultiEndoConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="MultiEndoLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="MultiEndoNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="MultiEndoNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>

                                    <!-- Pediatric fillings -->
                                    <tr>
                                        <td><strong>Pediatric Fillings</strong></td>
                                        <td>
                                            <input asp-for="PeadsNumber" type="number" class="form-control form-control-sm" min="0" placeholder="0">
                                        </td>
                                        <td>
                                            <select asp-for="PeadsConfidence" class="form-select form-select-sm" disabled="@(!ViewBag.CanEditMainFields)">
                                                <option value="">Select</option>
                                                <option value="1">1 - No confidence</option>
                                                <option value="2">2 - Very low</option>
                                                <option value="3">3 - Low</option>
                                                <option value="4">4 - Moderate</option>
                                                <option value="5">5 - High</option>
                                                <option value="6">6 - Very high</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input asp-for="PeadsLastDate" type="text" class="form-control form-control-sm" placeholder="e.g., Jan 2025">
                                        </td>
                                        <td>
                                            <div class="form-check">
                                                <input asp-for="PeadsNeedSupport" type="checkbox" class="form-check-input">
                                                <label asp-for="PeadsNeedSupport" class="form-check-label">Yes, I need support</label>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Advisor Comments Section - Only visible after performer saves -->
                @if (!string.IsNullOrEmpty(Model.AdvisorComment) || (ViewBag.CurrentUserRole == "advisor" || ViewBag.CurrentUserRole == "admin"))
                {
                    <div class="card mb-4">
                        <div class="card-header" style="background-color: #e8f5e8; color: #2d5a2d;">
                            <h5 class="mb-0">
                                <i class="bi bi-chat-dots"></i> Advisor Comments
                                @if (ViewBag.CurrentUserRole == "advisor" || ViewBag.CurrentUserRole == "admin")
                                {
                                    <small class="text-muted ms-2">(Advisor/Admin Only)</small>
                                }
                            </h5>
                        </div>
                        <div class="card-body">
                            @if (ViewBag.CurrentUserRole == "advisor" || ViewBag.CurrentUserRole == "admin")
                            {
                                <div class="mb-3">
                                    <textarea asp-for="AdvisorComment" class="form-control" rows="4" 
                                              placeholder="Enter comments for the performer about their assessment..."></textarea>
                                </div>
                            }
                            else
                            {
                                <div class="alert alert-info mb-0">
                                    @if (!string.IsNullOrEmpty(Model.AdvisorComment))
                                    {
                                        @Html.Raw(Model.AdvisorComment.Replace("\n", "<br/>"))
                                    }
                                    else
                                    {
                                        <em>No advisor comments yet.</em>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                }

                <input type="hidden" asp-for="Username" value="@ViewBag.PerformerUsername" />
                
                <div class="mt-4">
                    @if (ViewBag.CanEditMainFields || ViewBag.CanEditAdvisorComment)
                    {
                        <button type="submit" class="btn btn-primary btn-lg">Save Assessment</button>
                    }
                    else
                    {
                        <div class="alert alert-info">
                            <i class="bi bi-info-circle"></i> This assessment is view-only. Only supervisors, advisors, and admins can make changes.
                        </div>
                    }
                    <a href="/Dashboard/Index" class="btn btn-secondary btn-lg ms-2">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}

