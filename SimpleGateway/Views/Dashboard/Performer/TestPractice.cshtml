@model SimpleGateway.Models.TestDataModel
@{
    ViewData["Title"] = "Test Practice - PostgreSQL Save";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h2>Test Practice - @ViewBag.PerformerName</h2>
            @if (!string.IsNullOrEmpty(TempData["SuccessMessage"] as string))
            {
                <div class="alert alert-success">
                    @TempData["SuccessMessage"]
                    @if (TempData["TotalRecords"] != null)
                    {
                        <br><strong>Total records in PostgreSQL database:</strong> @TempData["TotalRecords"]
                    }
                </div>
            }
            
            @if (!string.IsNullOrEmpty(TempData["ErrorMessage"] as string))
            {
                <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
            }
        </div>
    </div>
    <div class="row">
        <div class="col-3">
            <ul class="list-group">
                <li class="list-group-item @(ViewBag.ActiveSection == "Dashboard" ? "active" : "")">
                    <a href="/Dashboard/Index" style="@(ViewBag.ActiveSection == "Dashboard" ? "color: white;" : "")">
                        <i class="bi bi-speedometer2"></i> Dashboard Overview
                    </a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "PerformerDetails" ? "active" : "")">
                    <a href="/Dashboard/PerformerDetails?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "PerformerDetails" ? "color: white;" : "")">Performer Details</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "TestPractice" ? "active" : "")">
                    <a href="/Dashboard/TestPractice?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "TestPractice" ? "color: white;" : "")">Test Practice</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "Uploads" ? "active" : "")">
                    <a href="/Dashboard/Uploads?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "Uploads" ? "color: white;" : "")">Uploads</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "StructuredConversation" ? "active" : "")">
                    <a href="/Dashboard/StructuredConversation?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "StructuredConversation" ? "color: white;" : "")">Structured Conversation</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "AgreementTerms" ? "active" : "")">
                    <a href="/Dashboard/AgreementTerms?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "AgreementTerms" ? "color: white;" : "")">Agreement Terms</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "WorkBasedAssessments" ? "active" : "")">
                    <a href="/Dashboard/WorkBasedAssessments?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "WorkBasedAssessments" ? "color: white;" : "")">Work Based Assessments</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "CPD" ? "active" : "")">
                    <a href="/Dashboard/CPD?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "CPD" ? "color: white;" : "")">CPD</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "MSF" ? "active" : "")">
                    <a href="/Dashboard/MSF?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "MSF" ? "color: white;" : "")">MSF</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "PSQ" ? "active" : "")">
                    <a href="/Dashboard/PSQ?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "PSQ" ? "color: white;" : "")">PSQ</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "ClinicalNoteAudit" ? "active" : "")">
                    <a href="/Dashboard/ClinicalNoteAudit?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "ClinicalNoteAudit" ? "color: white;" : "")">Clinical Note Audit</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "HelpGuidance" ? "active" : "")">
                    <a href="/Dashboard/HelpGuidance?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "HelpGuidance" ? "color: white;" : "")">Help & Guidance</a>
                </li>
                <li class="list-group-item @(ViewBag.ActiveSection == "FinalSignOff" ? "active" : "")">
                    <a href="/Dashboard/FinalSignOff?performerUsername=@ViewBag.PerformerUsername" style="@(ViewBag.ActiveSection == "FinalSignOff" ? "color: white;" : "")">Final Sign off</a>
                </li>
                @if (ViewBag.IsOwnDashboard == true)
                {
                    <li class="list-group-item"><a href="/Account/Logout">Logout</a></li>
                }
                else
                {
                    <li class="list-group-item"><a href="/Dashboard/Index">Back to List</a></li>
                }
            </ul>
        </div>
        
        <div class="col-9">
            <div class="card">
                <div class="card-header">
                    <h4>Test Practice - PostgreSQL Save Test</h4>
                    <p class="mb-0 text-muted">This section tests that data can be saved to the PostgreSQL database successfully.</p>
                </div>
                <div class="card-body">
                    <form asp-action="TestPractice" method="post">
                        <input type="hidden" asp-for="Username" />
                        
                        <!-- Question 1 -->
                        <div class="mb-4">
                            <label asp-for="UKWorkExperience" class="form-label">
                                <strong>Question 1:</strong> @Html.DisplayNameFor(m => m.UKWorkExperience)
                            </label>
                            <textarea asp-for="UKWorkExperience" class="form-control" rows="3" 
                                     placeholder="Please describe your work experience in the UK, if any. For example: '5 years as a dentist in London' or 'No UK work experience yet'"></textarea>
                            <span asp-validation-for="UKWorkExperience" class="text-danger"></span>
                        </div>
                        
                        <!-- Question 2 -->
                        <div class="mb-4">
                            <label asp-for="LastPatientTreatment" class="form-label">
                                <strong>Question 2:</strong> @Html.DisplayNameFor(m => m.LastPatientTreatment)
                            </label>
                            <textarea asp-for="LastPatientTreatment" class="form-control" rows="3" 
                                     placeholder="Please describe when you last treated a patient. For example: 'Yesterday - routine cleaning' or 'Last month - filling procedure'"></textarea>
                            <span asp-validation-for="LastPatientTreatment" class="text-danger"></span>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="mb-3">
                            <button type="submit" class="btn btn-primary btn-lg">Save Test Data to PostgreSQL</button>
                        </div>
                    </form>
                    
                    <div class="mt-4">
                        <div class="alert alert-info">
                            <h6><strong>Test Information:</strong></h6>
                            <p><strong>Purpose:</strong> This page tests if data can be successfully saved to the PostgreSQL database using the same pattern as the working PerformerDetails page.</p>
                            <p><strong>Database:</strong> Railway PostgreSQL</p>
                            <p><strong>Table:</strong> TestData</p>
                            <p><strong>Pattern:</strong> Following the exact same successful pattern as PerformerDetails</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
